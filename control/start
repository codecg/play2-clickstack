#!/bin/sh
set -e
set -u

control_dir="$(dirname $0)"
. $control_dir/config

cmd="$java -Djava.io.tmpdir=\"$tmp_dir\" -Dapp.port=$port -Dhttp.port=$port"
for file in `ls $control_dir/jvm-opts-* | sort`; do
    cmd="$cmd `cat $file`"
done

if [ -e "$working/target/start" ]
then
    cmd="$cmd -cp \"$working/target/staged/*\" play.core.server.NettyServer $working"
else
    cd $working/*
    cmd="$cmd -cp \"lib/*\" play.core.server.NettyServer ."
fi

exec bash -c "$cmd"
